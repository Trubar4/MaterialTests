!function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){function i(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=d(t);if(e){var a=d(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return f(this,n)}}function f(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function m(t,e,n){return e&&g(t.prototype,e),n&&g(t,n),t}var y=n(1);function v(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()+t()+t()}var b={},k=function(){function t(){h(this,t),this._frame=this.frame.bind(this)}return m(t,[{key:"start",value:function(t){this.cb=t.end,this.transitionForward=!t.back,this.startTime=window.performance.now(),requestAnimationFrame(this._frame)}},{key:"frame",value:function(){var t=(window.performance.now()-(this.startTime+this.timing.delay))/this.timing.dur,e=Math.max(0,Math.min(t,1));this.transitionForward?this.forward(e):this.back(e),window.performance.now()<=this.startTime+this.timing.dur+this.timing.delay?requestAnimationFrame(this._frame):this.end()}},{key:"end",value:function(){this.cb&&this.cb()}}]),t}(),N=function(t){c(n,t);var e=p(n);function n(t,i,a){var r;return h(this,n),(r=e.call(this)).from=t,r.to=i,r.timing={dur:0,delay:0},r}return m(n,[{key:"update",value:function(t){}},{key:"forward",value:function(t){}},{key:"back",value:function(t){}}]),n}(k);N.ports=function(t){return[]};var _=function(t){c(n,t);var e=p(n);function n(t,i,a){var r;return h(this,n),(r=e.call(this)).from=t,r.to=i,r.timing=a.timing||{curve:[0,0,.58,1],dur:300,delay:0},r.distance=a.shift||{value:25,unit:"%"},"number"==typeof r.distance&&(r.distance={value:r.distance,unit:"%"}),r.direction=a.direction||"Right",r.timing.curve[0]=Math.min(1,Math.max(0,r.timing.curve[0])),r.timing.curve[2]=Math.min(1,Math.max(0,r.timing.curve[2])),r.ease=y.apply(null,r.timing.curve),r.crossfade=void 0===a.crossfade||a.crossfade,r.zoom=a.zoom||{value:25,unit:"%"},"number"==typeof r.zoom&&(r.zoom={value:r.zoom,unit:"%"}),r}return m(n,[{key:"update",value:function(t){if("In"===this.direction||"Out"===this.direction){var e=this.zoom.value/100;e="Out"===this.direction?-e:e,this.from.setStyle({transform:"scale("+(1+e*t)+")",opacity:this.crossfade?1-t:1}),this.to.setStyle({transform:"scale("+(1-e*(1-t))+")",opacity:this.crossfade?t:1})}else{var n=this.distance.value,i=this.distance.unit,a={Up:{x:0,y:-1},Down:{x:0,y:1},Left:{x:-1,y:0},Right:{x:1,y:0}},r={x:a[this.direction].x*n,y:a[this.direction].y*n};this.from.setStyle({transform:"translate("+r.x*t+i+","+r.y*t+i+")",opacity:this.crossfade?1-t:1}),this.to.setStyle({transform:"translate("+r.x*(t-1)+i+","+r.y*(t-1)+i+")",opacity:this.crossfade?t:1})}}},{key:"forward",value:function(t){var e=this.ease(t);this.update(e)}},{key:"back",value:function(t){var e=this.ease(t);this.update(1-e)}}]),n}(k);_.ports=function(t){var e=[];return e.push({name:"tr-direction",displayName:"Direction",group:"Transition",type:{name:"enum",enums:["Right","Left","Up","Down","In","Out"]},default:"Right",plug:"input"}),"In"===t["tr-direction"]||"Out"===t["tr-direction"]?e.push({name:"tr-zoom",displayName:"Zoom",group:"Transition",type:{name:"number",units:["%"]},default:{value:25,unit:"%"},plug:"input"}):e.push({name:"tr-shift",displayName:"Shift Distance",group:"Transition",type:{name:"number",units:["%","px"]},default:{value:25,unit:"%"},plug:"input"}),e.push({name:"tr-crossfade",displayName:"Crossfade",group:"Transition",type:"boolean",default:!0,plug:"input"}),e.push({name:"tr-timing",displayName:"Timing",group:"Transition",type:"curve",plug:"input"}),e};var P=function(t){c(n,t);var e=p(n);function n(t,i,a){var r;return h(this,n),(r=e.call(this)).from=t,r.to=i,r.timing=a.timing||{curve:[0,0,.58,1],dur:300,delay:0},r.distance=a.shift||{value:25,unit:"%"},"number"==typeof r.distance&&(r.distance={value:r.distance,unit:"%"}),r.direction=a.direction||"Right",r.timing.curve[0]=Math.min(1,Math.max(0,r.timing.curve[0])),r.timing.curve[2]=Math.min(1,Math.max(0,r.timing.curve[2])),r.ease=y.apply(null,r.timing.curve),r.fadein=void 0!==a.fadein&&a.fadein,r.zoom=a.zoom||{value:25,unit:"%"},"number"==typeof r.zoom&&(r.zoom={value:r.zoom,unit:"%"}),r}return m(n,[{key:"update",value:function(t){if("In"===this.direction||"Out"===this.direction){var e=this.zoom.value/100;e="Out"===this.direction?-e:e,this.to.setStyle({transform:"scale("+(1-e*(1-t))+")",opacity:this.crossfade?t:1})}else{var n=this.distance.value,i=this.distance.unit,a={Up:{x:0,y:-1},Down:{x:0,y:1},Left:{x:-1,y:0},Right:{x:1,y:0}},r={x:a[this.direction].x*n,y:a[this.direction].y*n};this.to.setStyle({transform:"translate("+r.x*(t-1)+i+","+r.y*(t-1)+i+")",opacity:this.fadein?t:1})}}},{key:"forward",value:function(t){var e=this.ease(t);this.update(e)}},{key:"back",value:function(t){var e=this.ease(t);this.update(1-e)}}]),n}(k);P.ports=function(t){var e=[];return e.push({name:"tr-direction",displayName:"Direction",group:"Transition",type:{name:"enum",enums:["Right","Left","Up","Down","In","Out"]},default:"Right",plug:"input"}),"In"===t["tr-direction"]||"Out"===t["tr-direction"]?e.push({name:"tr-zoom",displayName:"Zoom",group:"Transition",type:{name:"number",units:["%"]},default:{value:25,unit:"%"},plug:"input"}):e.push({name:"tr-shift",displayName:"Shift Distance",group:"Transition",type:{name:"number",units:["%","px"]},default:{value:25,unit:"%"},plug:"input"}),e.push({name:"tr-fadein",displayName:"Fade In",group:"Transition",type:"boolean",default:!1,plug:"input"}),e.push({name:"tr-timing",displayName:"Timing",group:"Transition",type:"curve",plug:"input"}),e};var S={None:N,Push:_,Popup:P},O={node:{name:"PageStackNavigate",displayNodeName:"Navigate",category:"Navigation",initialize:function(){this._internal.transitionParams={},this._internal.pageParams={},this._internal.backResults={}},inputs:{stack:{type:{name:"string",identifierOf:"PackStack"},default:"Default",displayName:"Stack",group:"General",set:function(t){this._internal.stack=t}},target:{type:"component",displayName:"Target",group:"General",set:function(t){this._internal.target=t}},transition:{type:{name:"enum",enums:Object.keys(S)},default:"Push",displayName:"Transition",group:"Transition",set:function(t){this._internal.transition=t}},navigate:{displayName:"Navigate",group:"Actions",valueChangedToTrue:function(){this.scheduleNavigate()}}},methods:{scheduleNavigate:function(){var t=this,e=this._internal;e.hasScheduledNavigate||(e.hasScheduledNavigate=!0,this.scheduleAfterInputsHaveUpdated((function(){e.hasScheduledNavigate=!1,t.navigate()})))},navigate:function(){var t,e=this;(t=this._internal.stack&&"Default"!==this._internal.stack?b[this._internal.stack]:w)?t.navigate({target:this._internal.target,transition:o(o({},{type:this._internal.transition}),this._internal.transitionParams),params:this._internal.pageParams,backCallback:function(t,n){for(var i in e._internal.backResults=n,n)e.hasOutput("backResult-"+i)&&e.flagOutputDirty("backResult-"+i);void 0!==t&&e.sendSignalOnOutput(t)}}):console.log("No page stack found")},setTransitionParam:function(t,e,n){this._internal.transitionParams[t]=void 0!==n?{value:e,unit:n}:e},setPageParam:function(t,e){this._internal.pageParams[t]=e},getBackResult:function(t,e){return this._internal.backResults[t]},registerInputIfNeeded:function(t){if(!this.hasInput(t))return t.startsWith("tr-")?this.registerInput(t,{set:this.setTransitionParam.bind(this,t.substring("tr-".length))}):t.startsWith("pm-")?this.registerInput(t,{set:this.setPageParam.bind(this,t.substring("pm-".length))}):void 0},registerOutputIfNeeded:function(t){if(!this.hasOutput(t))return t.startsWith("backResult-")?this.registerOutput(t,{getter:this.getBackResult.bind(this,t.substring("backResult-".length))}):t.startsWith("backAction-")?this.registerOutput(t,{getter:function(){}}):void 0}}},setup:function(t,e){function n(n){function a(){var a=[],r=n.parameters.transition||"Push";if(S[r]&&(a=a.concat(S[r].ports(n.parameters))),void 0!==n.parameters.target){var o=e.components[n.parameters.target];if(void 0!==o){for(var s in o.inputPorts)a.push({name:"pm-"+s,displayName:s,type:"*",plug:"input",group:"Parameters"});var u,c=i(o.getNodesWithType("PageStackNavigateBack"));try{for(c.s();!(u=c.n()).done;){var l=u.value;void 0!==l.parameters.backActions&&l.parameters.backActions.split(",").forEach((function(t){a.find((function(e){return e.name==="backAction-"+t}))||a.push({name:"backAction-"+t,displayName:t,type:"signal",plug:"output",group:"Back Actions"})})),l.parameters.results&&l.parameters.results.split(",").forEach((function(t){a.find((function(e){return e.name==="backResult-"+t}))||a.push({name:"backResult-"+t,displayName:t,type:"*",plug:"output",group:"Back Results"})}))}}catch(t){c.e(t)}finally{c.f()}}}t.editorConnection.sendDynamicPorts(n.id,a)}function r(t){if(void 0!==t){var n=e.components[t];if(void 0!==n){n.on("inputPortAdded",a),n.on("inputPortRemoved",a);var r,o=i(n.getNodesWithType("PageStackNavigateBack"));try{for(o.s();!(r=o.n()).done;){r.value.on("parameterUpdated",a)}}catch(t){o.e(t)}finally{o.f()}n.on("nodeAdded",(function(t){"PageStackNavigateBack"===t.type&&(t.on("parameterUpdated",a),a())})),n.on("nodeWasRemoved",(function(t){"PageStackNavigateBack"===t.type&&a()}))}}}a(),r(n.parameters.target),n.on("parameterUpdated",(function(t){"target"===t.name?(r(n.parameters.target),a()):("transition"===t.name||t.name.startsWith("tr-"))&&a()}))}t.editorConnection&&t.editorConnection.isRunningLocally()&&e.on("editorImportComplete",(function(){e.on("nodeAdded.PageStackNavigate",(function(t){n(t)}));var t,a=i(e.getNodesWithType("PageStackNavigate"));try{for(a.s();!(t=a.n()).done;){n(t.value)}}catch(t){a.e(t)}finally{a.f()}}))}};var w,T={node:{name:"PageStackNavigateBack",displayNodeName:"Navigate Back",category:"Navigation",inputs:{stack:{type:{name:"string",identifierOf:"PackStack"},default:"Default",displayName:"Stack",group:"General",set:function(t){this._internal.stack=t}},navigate:{displayName:"Navigate",group:"Actions",valueChangedToTrue:function(){this.scheduleNavigate()}},results:{type:{name:"stringlist",allowEditOnly:!0},group:"Results",set:function(t){this._internal.results=t}},backActions:{type:{name:"stringlist",allowEditOnly:!0},group:"Back Actions",set:function(t){this._internal.backActions=t}}},initialize:function(){this._internal.resultValues={}},methods:{scheduleNavigate:function(){var t=this,e=this._internal;e.hasScheduledNavigate||(e.hasScheduledNavigate=!0,this.scheduleAfterInputsHaveUpdated((function(){e.hasScheduledNavigate=!1,t.navigate()})))},navigate:function(){var t;(t=this._internal.stack&&"Default"!==this._internal.stack?b[this._internal.stack]:w)?t.back({backAction:this._internal.backAction,results:this._internal.resultValues}):console.log("No page stack found")},setResultValue:function(t,e){this._internal.resultValues[t]=e},backActionTriggered:function(t){this._internal.backAction=t,this.scheduleNavigate()},registerInputIfNeeded:function(t){var e,n;if(!this.hasInput(t))return t.startsWith("result-")?this.registerInput(t,{set:this.setResultValue.bind(this,t.substring("result-".length))}):t.startsWith("backAction-")?this.registerInput(t,{set:(e={valueChangedToTrue:this.backActionTriggered.bind(this,t)},n=!1,function(t){(t=!!t)&&!1===n&&e.valueChangedToTrue.call(this),n=t})}):void 0}}},setup:function(t,e){function n(e){function n(){var n=[],i=e.parameters.results;if(i)for(var a in i=i?i.split(","):void 0){var r=i[a];n.push({type:{name:"*"},plug:"input",group:"Results",name:"result-"+r,displayName:r})}var o=e.parameters.backActions;if(o)for(var a in o=o?o.split(","):void 0){r=o[a];n.push({type:"signal",plug:"input",group:"Back Actions",name:"backAction-"+r,displayName:r})}t.editorConnection.sendDynamicPorts(e.id,n)}n(),e.on("parameterUpdated",(function(t){"results"!==t.name&&"backActions"!==t.name||n()}))}t.editorConnection&&t.editorConnection.isRunningLocally()&&e.on("editorImportComplete",(function(){e.on("nodeAdded.PageStackNavigateBack",(function(t){n(t)}));var t,a=i(e.getNodesWithType("PageStackNavigateBack"));try{for(a.s();!(t=a.n()).done;){n(t.value)}}catch(t){a.e(t)}finally{a.f()}}))}},R={name:"Page Stack",displayNodeName:"Navigation Stack",category:"Visuals",initialize:function(){this._internal.stack=[],this._internal.topPageName="",this._internal.stackDepth=0},getReactComponent:function(){var t=this;return function(e){var n={width:"100%",height:"100%",position:"relative",backgroundColor:t._internal.backgroundColor};return React.createElement("div",{style:n},e.children)}},inputs:{name:{type:{name:"string",identifierOf:"PackStack"},displayName:"Name",group:"General",set:function(t){this._internal.name=t,b[this._internal.name]=this}},startPage:{type:"component",displayName:"Start Page",group:"General",set:function(t){this._internal.startPage=t,this.scheduleReset()}},backgroundColor:{type:"color",displayName:"Background Color",group:"Style",set:function(t){this._internal.backgroundColor=t}},reset:{type:"signal",displayName:"Reset",group:"Actions",valueChangedToTrue:function(){this.scheduleReset()}}},outputs:{topPageName:{type:"string",displayName:"Top Page Name",get:function(){return this._internal.topPageName}},stackDepth:{type:"number",displayName:"Stack Depth",get:function(){return this._internal.stackDepth}}},methods:{setPageOutputs:function(t){for(var e in t)this._internal[e]=t[e],this.flagOutputDirty(e)},scheduleReset:function(){var t=this,e=this._internal;e.hasScheduledReset||(e.hasScheduledReset=!0,this.scheduleAfterInputsHaveUpdated((function(){e.hasScheduledReset=!1,t.reset()})))},reset:function(t){var e=this.getChildren();for(var n in e){var i=e[n];this.removeChild(i),this.nodeScope.deleteNode(i)}var a=this.nodeScope.createNode("Group",v());a.setInputValue("flexDirection","none"),t||(t=this.nodeScope.createNode(this._internal.startPage,v())),a.addChild(t),this.addChild(a),this._internal.stack=[{from:null,page:a,componentName:this._internal.startPage}],this.setPageOutputs({topPageName:this._internal.startPage,stackDepth:this._internal.stack.length})},navigate:function(t){var e=this;if(!this._internal.isTransitioning){var n=this.nodeScope.createNode("Group",v());n.setInputValue("flexDirection","none"),n.setInputValue("position","absolute");var i=this.nodeScope.createNode(t.target,v());for(var a in t.params)i.setInputValue(a,t.params[a]);n.addChild(i);var r=this._internal.stack[this._internal.stack.length-1],o={from:r.page,page:n,transition:new S[t.transition.type||"Push"](r.page,n,t.transition),backCallback:t.backCallback,componentName:t.target};this._internal.stack.push(o),this.setPageOutputs({topPageName:t.target,stackDepth:this._internal.stack.length}),o.transition.forward(0),this._internal.isTransitioning=!0,o.transition.start({end:function(){e._internal.isTransitioning=!1,e.removeChild(r.page)}}),this.addChild(n)}},back:function(t){var e=this;if(!(this._internal.stack.length<=1||this._internal.isTransitioning)){var n=this._internal.stack[this._internal.stack.length-1];this.addChild(n.from,0),n.backCallback&&n.backCallback(t.backAction,t.results),this.setPageOutputs({topPageName:this._internal.stack[this._internal.stack.length-2].componentName,stackDepth:this._internal.stack.length-1}),this._internal.isTransitioning=!0,n.transition.start({end:function(){e._internal.isTransitioning=!1,e.removeChild(n.page),e.nodeScope.deleteNode(n.page),e._internal.stack.pop()},back:!0})}}}};Noodl.defineModule({reactNodes:[R],nodes:[O,T],settings:[{type:"color",name:"navigationBackgroundColor",displayName:"Background Color",group:"Navigation",plug:"input"}],setup:function(){},_injectRootRender:function(t){return w||(w=t.nodeScope.createNode("Page Stack")).setInputValue("backgroundColor",Noodl.getProjectSettings().navigationBackgroundColor),w.reset(t),w}})},function(t,e){var n="function"==typeof Float32Array;function i(t,e){return 1-3*e+3*t}function a(t,e){return 3*e-6*t}function r(t){return 3*t}function o(t,e,n){return((i(e,n)*t+a(e,n))*t+r(e))*t}function s(t,e,n){return 3*i(e,n)*t*t+2*a(e,n)*t+r(e)}function u(t){return t}t.exports=function(t,e,i,a){if(!(0<=t&&t<=1&&0<=i&&i<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&i===a)return u;for(var r=n?new Float32Array(11):new Array(11),c=0;c<11;++c)r[c]=o(.1*c,t,i);function l(e){for(var n=0,a=1;10!==a&&r[a]<=e;++a)n+=.1;--a;var u=n+.1*((e-r[a])/(r[a+1]-r[a])),c=s(u,t,i);return c>=.001?function(t,e,n,i){for(var a=0;a<4;++a){var r=s(e,n,i);if(0===r)return e;e-=(o(e,n,i)-t)/r}return e}(e,u,t,i):0===c?u:function(t,e,n,i,a){var r,s,u=0;do{(r=o(s=e+(n-e)/2,i,a)-t)>0?n=s:e=s}while(Math.abs(r)>1e-7&&++u<10);return s}(e,n,n+.1,t,i)}return function(t){return 0===t?0:1===t?1:o(l(t),e,a)}}}]);
//# sourceMappingURL=index.js.map